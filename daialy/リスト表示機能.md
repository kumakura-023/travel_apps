# リスト表示機能 – 実装記録

## 使っている技術スタック

- React 18 + Vite
- TypeScript 5
- Zustand (状態管理)
- TailwindCSS + デザインシステム (design_rule.md)
- React Icons (簡易アイコン)
- 素の SVG を使用した円グラフ (外部チャートライブラリ不使用)

## 機能の概要

「候補地リスト & コスト管理」を Map / TravelTime に続く 3 つ目のタブとして追加。

- 候補地をカード形式で一覧表示
- カテゴリフィルター・検索・ソート (名前 / コスト / 追加日)
- コスト編集・合計金額表示・カテゴリ別内訳
- 円グラフでカテゴリ別コストを可視化

## 背景・目的

- 地点を地図上だけでなく一覧で確認・編集したいという要望
- 旅行予算を把握しやすくするため概算コストの集計 UI が必要

## コンポーネント設計

| コンポーネント   | 単一責任                          | 依存             | 備考                                    |
| ---------------- | --------------------------------- | ---------------- | --------------------------------------- |
| `PlaceList`      | 検索/フィルター/UI レイアウト全体 | `usePlacesStore` | 固定フルスクリーンパネル                |
| `PlaceListItem`  | Place カード + コスト編集         | `usePlacesStore` | インライン編集で `updatePlace` 呼び出し |
| `CategoryFilter` | カテゴリ複数選択 UI               | なし             | tokens は design_rule に準拠            |
| `CostSummary`    | 合計 & カテゴリ内訳計算/表示      | Utils            | テーブルで表示                          |
| `CostPieChart`   | 円グラフ描画 (SVG)                | Utils            | 小規模データ想定                        |

## できること・制限事項

✅ 検索・カテゴリ絞り込み・ソート (昇降順)
✅ 概算コスト編集と即時再計算
✅ カテゴリ別簡易円グラフ
⚠️ 詳細な統計や複数通貨対応は未実装
⚠️ 円グラフはデータが無い場合は非表示

## コンポーネント使用時のオプション

`PlaceList` は内部ステートで完結し、外部 Props は無し。
他子コンポーネントも必要最小限の Props のみ。

## 関連ファイル・ディレクトリ構造

```
src/components/
  ├─ PlaceList.tsx
  ├─ PlaceListItem.tsx
  ├─ CategoryFilter.tsx
  ├─ CostSummary.tsx
  └─ CostPieChart.tsx
daialy/
  └─ リスト表示機能.md (このファイル)
```

## 注意点

- **単一責任原則**: それぞれのコンポーネントは UI 1 つ/集計 1 つなど責務を限定。
- **インターフェース依存**: Store とのやり取りは `usePlacesStore` の公開メソッド経由。
- 大量データにはパフォーマンス最適化 (仮想リスト) が将来必要。
- Map との重なりを避けるため `z-30` で最前面固定。
- SVG 円グラフは IE 未対応だが当プロジェクトのターゲットブラウザ要件を満たす。
